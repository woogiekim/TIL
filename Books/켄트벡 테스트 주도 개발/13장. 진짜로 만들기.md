# 진짜로 만들기

- 이전에는 가짜 구현이 있을 때 진짜 구현으로 거꾸로 작업해 가는 것이 명확했다.
- 단순히 상수를 변수로 치환하는 일이었다. 그렇지만 이번에는 어떻게 거꾸로 작업해야 할지 분명하지 않다.
- 그래서 조금 불확실한 감이 있긴 하지만 순방향으로 작업해보자.


- 두 Money의 합은 Sum이어야 한다.

```java
public void testPlusReturnsSum() {
    Money five = Money.dollar(5);
    Expression result = five.plus(five);
    Sum sum = (Sum) result;
    assertEquals(five, sum.augend);
    assertEquals(five, sum.addend);
}
```

- 위테스트는 그리 오래가지 못할 것이다. 위 테스트는 수행하고자 하는 연산의 외부 행위가 아닌 내부 구현에 대해 너무 깊게 관여하고 있다.
- 그렇긴 해도 일단 이 테스트를 통과하면 목표에 한 걸음 더 다가가게 될 것이다.


- 간단히 고칠 수 있는 문제들이다. 언젠가는 Bank가 매개변수가 되어야할 거라고 `확신`이 들지만 이건 정말 간단한 리팩토링이기 때문에 일단은 나중을 위해 남겨두도록 한다.


- 지저분하다, 지저분해. 그래도 초록 막대 상태이므로 리팩토링을 할 수 있다.
- 클래스를 명시적으로 검사하는 코드가 있을 때에는 항상 다형성을 사용하도록 바꾸는 것이 좋다.


- Expression과 Bank에 이름은 동일하지만 매개 변수 형이 다른 메소드가 있다는 것이 만족스럽지는 않다.
- 난 나바에서 이런 종류의 문제에 대한 만족할 만한 일반적인 해법을 찾지 못했다.
- 키워드 매개 변수를 지원하는 언어에서는 Bank.recude(Expression, String)와 Expression.reduce(String)의 차이점에 대한 의도를 명백히 표현할 수 있도록 문법 차원에서 지원을 해준다.
- 위치 매개 변수만으로는 두 메소드가 어떻게 다른지에 대해 코드에 명확히 담아내는 것이 쉽지 않다.


